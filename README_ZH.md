<h1 align="center">
<font color="#FF0000">@</font><font color="#F90006">c</font><font color="#F3000C">a</font><font color="#ED0012">r</font><font color="#E70018">d</font><font color="#E1001E">b</font><font color="#DB0024">r</font><font color="#D5002A">o</font><font color="#CF0030">t</font><font color="#C90036">h</font><font color="#C3003C">e</font><font color="#BD0042">r</font><font color="#B70048">/</font><font color="#B1004E">n</font><font color="#AB0054">e</font><font color="#A5005A">s</font><font color="#9F0060">t</font><font color="#990066">j</font><font color="#93006C">s</font><font color="#8D0072">-</font><font color="#870078">t</font><font color="#81007E">e</font><font color="#7B0084">n</font><font color="#75008A">c</font><font color="#6F0090">e</font><font color="#690096">n</font><font color="#63009C">t</font><font color="#5D00A2">-</font><font color="#5700A8">c</font><font color="#5100AE">l</font><font color="#4B00B4">o</font><font color="#4500BA">u</font><font color="#3F00C0">d</font><font color="#3900C6">-</font><font color="#3300CC">s</font><font color="#2D00D2">d</font><font color="#2700D8">k</font></h1>
<small style="text-align:center;display:flex;justify-content:center;gap:5px;"><a href="https://github.com/guotingchao/nest-tencent-cloud-sdk/actions/workflows/Test.yml"><img alt="CI" src="https://github.com/guotingchao/nest-tencent-cloud-sdk/actions/workflows/CI.yml/badge.svg"/></a> <a href="https://github.com/guotingchao/nest-tencent-cloud-sdk/actions/workflows/Release.yml"><img alt="Release &amp; Publish" src="https://github.com/guotingchao/nest-tencent-cloud-sdk/actions/workflows/Release.yml/badge.svg"/></a> <a href="https://badge.fury.io/js/@cardbrother%2Fnestjs-tencent-cloud-sdk"><img alt="package version" src="https://badge.fury.io/js/@cardbrother%2Fnestjs-tencent-cloud-sdk.svg"/></a> <img alt="NPM Downloads" src="https://img.shields.io/npm/d18m/%40cardbrother%2Fnestjs-tencent-cloud-sdk"/>
</small>
<small style="text-align:center;display:flex;justify-content:center;gap:5px;">
<img alt="GitHub language count" src="https://img.shields.io/github/languages/count/guotingchao/nest-tencent-cloud-sdk?color=green"/> <img alt="GitHub commit activity (branch)" src="https://img.shields.io/github/commit-activity/t/guotingchao/nest-tencent-cloud-sdk/main?logo=github&amp;logoColor=green&amp;color=%23FF40E0D0"/>
<img alt="GitHub commit activity (branch)" src="https://img.shields.io/github/commit-activity/t/guotingchao/nest-tencent-cloud-sdk/develop?logo=github&amp;logoColor=green&amp;label=Develop%20Commits&amp;color=%23FF40E0D0"/>
</small>
<small style="display:flex;padding: 3px 0; justify-content:center; align-items:center;">🚨 <strong style="width:200px;">tencentcloud-sdk-nodejs</strong>  <img alt="GitHub Tag" src="https://img.shields.io/github/v/tag/TencentCloud/tencentcloud-sdk-nodejs?color=slateblue&labelColor=red&label=version"></small>
<small style="display:flex;padding: 3px 0; justify-content:center; align-items:center;">🚨 <strong style="width:200px;">cos-nodejs-sdk-v5</strong>  <img alt="GitHub Tag" src="https://img.shields.io/github/v/tag/tencentyun/cos-nodejs-sdk-v5
?color=slateblue&labelColor=red&label=version"></small>

<h3 align="center">
<small style="text-align:center; display:block;"><strong>Language: <a href="README.md">English</a></strong></small>
<font color="#00C0FF">t</font><font color="#03BDFC">e</font><font color="#06BAF9">n</font><font color="#09B7F6">c</font><font color="#0CB4F3">e</font><font color="#0FB1F0">n</font><font color="#12AEED">t</font><font color="#15ABEA">c</font><font color="#18A8E7">l</font><font color="#1BA5E4">o</font><font color="#1EA2E1">u</font><font color="#219FDE">d</font><font color="#249CDB">-</font><font color="#2799D8">s</font><font color="#2A96D5">d</font><font color="#2D93D2">k</font><font color="#3090CF">-</font><font color="#338DCC">n</font><font color="#368AC9">o</font><font color="#3987C6">d</font><font color="#3C84C3">e</font><font color="#3F81C0">j</font><font color="#427EBD">s</font><font color="#457BBA"> </font><font color="#4878B7">&</font><font color="#4B75B4"> </font><font color="#4E72B1">c</font><font color="#516FAE">o</font><font color="#546CAB">s</font><font color="#5769A8">-</font><font color="#5A66A5">n</font><font color="#5D63A2">o</font><font color="#60609F">d</font><font color="#63609C">e</font><font color="#666099">j</font><font color="#696096">s</font><font color="#6C6093">-</font><font color="#6F6090">s</font><font color="#72608D">d</font><font color="#75608A">k</font><font color="#786087">-</font><font color="#7B6084">v</font><font color="#7E6081">5</font><font color="#81607E"> </font><font color="#84607B">f</font><font color="#876078">o</font><font color="#8A6075">r</font><font color="#8D6072"> </font><font color="#90606F">N</font><font color="#93606C">e</font><font color="#966069">s</font><font color="#996066">t</font><font color="#9C6063">J</font><font color="#9F6060">S</font><font color="#A2605D"> </font><font color="#A5605A">d</font><font color="#A86057">e</font><font color="#AB6054">v</font><font color="#AE6051">e</font><font color="#B1604E">l</font><font color="#B4604B">o</font><font color="#B76048">p</font><font color="#BA6045">e</font><font color="#BD6042">r</font><font color="#C0603F">s</font>
</h3>

## 🔨 安装

- npm

```bash
npm install @cardbrother/nest-tencent-cloud-sdk
```

- yarn

```bash
$ yarn add @cardbrother/nest-tencent-cloud-sdk
```

- 🚀 pnpm **推荐**

```bash
$ pnpm add @cardbrother/nest-tencent-cloud-sdk
```

## 🍚 使用

> 在 `AppModule` 或 `FeatureModule` 模块中，导入 `TencentCloudModule` 并调用 `forRoot` 方法配置 Tencent Cloud SDK 的 `secretId` 和 `secretKey`：

#### **基础使用:**

```ts
import { Module } from '@nestjs/common';
import { TencentCloudModule } from '@cardbrother/nest-tencent-cloud-sdk';

@Module({
  imports: [
    TencentCloudModule.forRoot({
      apiId: 'TENCENT_API_ID',
      apiSecret: 'TENCENT_API_SECRET',
      region: 'TENCENT_REGION',
      cos: {
        Bucket: 'COS_BUCKET',
        Region: 'COS_REGION',
        SecretId: 'COS_SECRET_ID',
        SecretKey: 'COS_SECRET_KEY',
      },
      global: true, // 如果为 true，则 TencentCloudService 将是全局服务，默认为 false
    }),
  ],
})
export class AppModule {}
```

---

#### **动态模块导入**

> 如果您想使用动态配置，可以使用 `forRootAsync` 方法将您的 `secretId` 和 `secretKey` 配置为腾讯云 SDK：

```ts
import { TencentCloudModule } from '@cardbrother/nestjs-tencent-cloud-sdk';
import { Module } from '@nestjs/common';
import { ConfigModule, ConfigService } from '@nestjs/config';

@Module({
  imports: [
    ConfigModule.forRoot({
      isGlobal: true,
    }),
    TencentCloudModule.forRootAsync({
      useFactory: async (configService: ConfigService) => ({
        apiId: configService.get<string>('TENCENT_API_ID'),
        apiSecret: configService.get<string>('TENCENT_API_SECRET'),
        region: configService.get<string>('TENCENT_REGION', 'ap-shanghai'),
        cos: {
          Bucket: configService.get<string>('COS_BUCKET'),
          Region: configService.get<string>('COS_REGION'),
          SecretId: configService.get<string>('COS_SECRET_ID'),
          SecretKey: configService.get<string>('COS_SECRET_KEY'),
        },
        global: true, // 如果为 true，则 TencentCloudService 将是全局服务，默认为 false
      }),
      imports: [ConfigModule],
      inject: [ConfigService],
      global: true,
    }),
  ],
})
export class AppModule {}
```

#### **使用 TencentCloudService**

```ts
import { Injectable } from '@nestjs/common';
import { TencentCloudService } from '@cardbrother/nest-tencent-cloud-sdk';

@Injectable()
export class AppService {
  constructor(
    private readonly tencentCloudService: TencentCloudService,
    @Inject(TENCENT_CLOUD_MODULE_OPTIONS_TOKEN)
    private readonly options: TencentCloudModuleOptions, // 如果您想获取选项，可以使用这个
  ) {}

  // 使用 OCR 服务
  async useOCR(imgData: string) {
    // 封装对象是智能的根据枚举动态实例化的
    const ocrClient = await this.tencentCloudService.useClient('OCR'); // or SMS,COS,etc
    return ocrClient.fastOcr({
      ImageBase64: imgData,
    });
  }
}
```

#### **使用 Tencent COS**

> 💡 提示：如果在此处传递 Bucket、Region 或任何参数，则会覆盖导入模块时的配置；如果不传递，则会使用导入的 `TencentCloudModule.forRoot` 配置。

```ts
const cosClient = await this.tencentCloudService.useClient('COS');
cosClient.upload({
  Bucket: this.options.cos.Bucket, // It's not required. Default use the configuration at the Module Import time
  Region: this.options.cos.Region, // It's not required. Default use the configuration at the Module Import time
  Key: 'test.txt',
  Body: 'hello world',
  FilePath: 'test.txt',
});
```

#### 📝 [CHANGELOG](CHANGELOG.md)

#### License [MIT](https://github.com/guotingchao/nest-tencent-cloud-sdk/blob/main/LICENSE)
